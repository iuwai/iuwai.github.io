<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Iuwai</title>
  
  <subtitle>学如逆水行舟，不进则退。</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.iuwai.com/"/>
  <updated>2020-09-05T08:33:13.965Z</updated>
  <id>http://www.iuwai.com/</id>
  
  <author>
    <name>Iuwai</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>booklist</title>
    <link href="http://www.iuwai.com/2018/11/10/booklist/"/>
    <id>http://www.iuwai.com/2018/11/10/booklist/</id>
    <published>2018-11-10T02:56:43.000Z</published>
    <updated>2020-09-05T08:33:13.965Z</updated>
    
    <content type="html"><![CDATA[<p>一日不读书、不思考便觉自己在堕落<br><a id="more"></a></p><h3 id="传记"><a href="#传记" class="headerlink" title="传记"></a>传记</h3><table><thead><tr><th style="text-align:center">序号</th><th style="text-align:left">书名</th><th style="text-align:left">作者</th><th style="text-align:left">时间</th><th style="text-align:center">阅读状态</th></tr></thead><tbody><tr><td style="text-align:center">2</td><td style="text-align:left"><a href="https://book.douban.com/subject/26664352/" target="_blank" rel="noopener">褚时健传</a></td><td style="text-align:left">周桦</td><td style="text-align:left">2019.11.9~2019.12</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">1</td><td style="text-align:left"><a href="https://book.douban.com/subject/20427187/" target="_blank" rel="noopener">看见</a></td><td style="text-align:left">柴静</td><td style="text-align:left">2019.4</td><td style="text-align:center">100%</td></tr></tbody></table><h3 id="小说"><a href="#小说" class="headerlink" title="小说"></a>小说</h3><table><thead><tr><th style="text-align:center">序号</th><th style="text-align:left">书名</th><th style="text-align:left">作者</th><th style="text-align:left">时间</th><th style="text-align:center">阅读状态</th></tr></thead><tbody><tr><td style="text-align:center">27</td><td style="text-align:left">[西游记]</td><td style="text-align:left">吴承恩</td><td style="text-align:left">2020.5</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">26</td><td style="text-align:left"><a href="https://book.douban.com/subject/25900802/" target="_blank" rel="noopener">我在底层的生活</a></td><td style="text-align:left">[美] 芭芭拉·艾伦瑞克</td><td style="text-align:left">2019.10</td><td style="text-align:center">80%</td></tr><tr><td style="text-align:center">25</td><td style="text-align:left"><a href="https://book.qidian.com/info/3333529" target="_blank" rel="noopener">道门法则</a></td><td style="text-align:left">八宝饭</td><td style="text-align:left">2019.11</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">24</td><td style="text-align:left"><a href="https://book.douban.com/subject/33379779/" target="_blank" rel="noopener">美国陷阱</a></td><td style="text-align:left">[法] 弗雷德里克·皮耶鲁齐 / [法] 马修·阿伦</td><td style="text-align:left">2019.7</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">23</td><td style="text-align:left"><a href="https://book.douban.com/subject/30306452/" target="_blank" rel="noopener">极速写作</a></td><td style="text-align:left">剑飞</td><td style="text-align:left">2019.7</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">22</td><td style="text-align:left"><a href="https://book.douban.com/subject/26899537/" target="_blank" rel="noopener">长安十二时辰</a></td><td style="text-align:left">马伯庸</td><td style="text-align:left">2019.7</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">21</td><td style="text-align:left"><a href="https://book.douban.com/subject/30475767/" target="_blank" rel="noopener">人生海海</a></td><td style="text-align:left">麦家</td><td style="text-align:left">2019.6</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">20</td><td style="text-align:left">解忧杂货店</td><td style="text-align:left">［日］东野圭吾</td><td style="text-align:left">2018</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">19</td><td style="text-align:left">秘密</td><td style="text-align:left">［日］东野圭吾</td><td style="text-align:left">2018</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">18</td><td style="text-align:left">古董局中局</td><td style="text-align:left">马伯庸</td><td style="text-align:left">2018</td><td style="text-align:center">10%</td></tr><tr><td style="text-align:center">17</td><td style="text-align:left">路西法效应</td><td style="text-align:left">［美］菲利普·津巴多【译】</td><td style="text-align:left">2018</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">16</td><td style="text-align:left">趣味生活简史</td><td style="text-align:left">［英］比尔·布莱森【严维明译】</td><td style="text-align:left">2018</td><td style="text-align:center">76%</td></tr><tr><td style="text-align:center">15</td><td style="text-align:left">天长地久</td><td style="text-align:left">龙应台</td><td style="text-align:left">2018.11</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">14</td><td style="text-align:left">荆州杀</td><td style="text-align:left">朱苏进、李蔷薇</td><td style="text-align:left">2018</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">13</td><td style="text-align:left">三体</td><td style="text-align:left">刘慈欣</td><td style="text-align:left">2018</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">12</td><td style="text-align:left">老人与海</td><td style="text-align:left">海明威</td><td style="text-align:left">2018</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">11</td><td style="text-align:left">屠夫十字镇</td><td style="text-align:left">［美］约翰·威廉斯【李广荣译】</td><td style="text-align:left">2018</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">10</td><td style="text-align:left">战天京</td><td style="text-align:left">谭伯牛</td><td style="text-align:left">2018</td><td style="text-align:center">2%</td></tr><tr><td style="text-align:center">9</td><td style="text-align:left">琅琊榜</td><td style="text-align:left">海晏</td><td style="text-align:left">2017</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">8</td><td style="text-align:left">明朝那些事儿</td><td style="text-align:left">当年明月</td><td style="text-align:left">&lt;2016</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">7</td><td style="text-align:left">藏地密码</td><td style="text-align:left">何马</td><td style="text-align:left">&lt;2016</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">6</td><td style="text-align:left">三国演义</td><td style="text-align:left">罗贯中</td><td style="text-align:left">&lt;2016</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">5</td><td style="text-align:left">水浒传</td><td style="text-align:left">施耐庵</td><td style="text-align:left">&lt;2016</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">4</td><td style="text-align:left">康熙大帝、雍正皇帝、乾隆皇帝</td><td style="text-align:left">二月河</td><td style="text-align:left">&lt;2016</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">3</td><td style="text-align:left">金瓶梅</td><td style="text-align:left">兰陵笑笑生</td><td style="text-align:left">&lt;2016</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">2</td><td style="text-align:left">杜月笙全传</td><td style="text-align:left">【忘记】</td><td style="text-align:left">&lt;2016</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">1</td><td style="text-align:left">无尾狗</td><td style="text-align:left">阿丁</td><td style="text-align:left">&lt;2016</td><td style="text-align:center">100%</td></tr></tbody></table><h3 id="技术类"><a href="#技术类" class="headerlink" title="技术类"></a>技术类</h3><table><thead><tr><th style="text-align:center">序号</th><th style="text-align:left">书名</th><th style="text-align:left">作者</th><th style="text-align:left">时间</th><th style="text-align:center">阅读状态</th></tr></thead><tbody><tr><td style="text-align:center">9</td><td style="text-align:left"><a href="https://book.douban.com/subject/24737674/" target="_blank" rel="noopener">图解TCP/IP</a></td><td style="text-align:left">[日]竹下隆史 / [日]村山公保 / [日]荒井透 / [日]苅田幸雄 / 【乌尼日其其格译】</td><td style="text-align:left">2019</td><td style="text-align:center">20%</td></tr><tr><td style="text-align:center">8</td><td style="text-align:left">深入浅出Prometheus：原理、应用、源码与拓展详解</td><td style="text-align:left">陈晓宇 / 杨川胡 / 陈啸</td><td style="text-align:left">2019</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">7</td><td style="text-align:left">Kubernetes权威指南——企业级容器云实战</td><td style="text-align:left">闫健勇 / 龚正 / 吴治辉 / 刘晓红 / 崔秀龙</td><td style="text-align:left">2019</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">6</td><td style="text-align:left"><a href="https://book.douban.com/subject/26644070/" target="_blank" rel="noopener">凤凰项目</a></td><td style="text-align:left">基恩·金 (Gene Kim) / 凯文·贝尔 (Kevin Behr) / 乔治·斯帕福德 (George Spafford) 【成小留】</td><td style="text-align:left">2018</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">5</td><td style="text-align:left">每天5分钟玩转Docker</td><td style="text-align:left">CloudMan</td><td style="text-align:left">2018</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">4</td><td style="text-align:left">每天5分钟玩转Kubernetes</td><td style="text-align:left">CloudMan</td><td style="text-align:left">2018</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">3</td><td style="text-align:left"><a href="https://book.douban.com/subject/4843567/" target="_blank" rel="noopener">深入Linux内核架构</a></td><td style="text-align:left">［德］Wolfgang Mauerer【郭旭译】</td><td style="text-align:left">2015~</td><td style="text-align:center">10%</td></tr><tr><td style="text-align:center">2</td><td style="text-align:left">DevOps</td><td style="text-align:left">［美］Sanjeev Sharma【万金译】</td><td style="text-align:left">2018.10</td><td style="text-align:center">30%</td></tr><tr><td style="text-align:center">1</td><td style="text-align:left">流畅的Python</td><td style="text-align:left">［巴西］Luciano Ramalho【安道、吴珂译】</td><td style="text-align:left">2017~</td><td style="text-align:center">80%</td></tr></tbody></table><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><table><thead><tr><th style="text-align:center">序号</th><th style="text-align:left">书名</th><th style="text-align:left">作者</th><th style="text-align:left">时间</th><th style="text-align:center">阅读状态</th></tr></thead><tbody><tr><td style="text-align:center">16</td><td style="text-align:left"><a href="https://book.douban.com/subject/30346218/" target="_blank" rel="noopener">态度-吴军家书</a></td><td style="text-align:left">吴军</td><td style="text-align:left">2020.9~</td><td style="text-align:center">27%</td></tr><tr><td style="text-align:center">16</td><td style="text-align:left"><a href="https://book.douban.com/subject/27055728/" target="_blank" rel="noopener">如何成为一个有趣的人</a></td><td style="text-align:left">王小圈</td><td style="text-align:left">2020.9~</td><td style="text-align:center">18%</td></tr><tr><td style="text-align:center">15</td><td style="text-align:left"><a href="https://book.douban.com/subject/34464343/" target="_blank" rel="noopener">学会呼吸-重新掌握天生本能</a></td><td style="text-align:left">[爱尔兰] 帕特里克·麦基翁 / Patrick McKeown</td><td style="text-align:left">2020.8~</td><td style="text-align:center">13%</td></tr><tr><td style="text-align:center">14</td><td style="text-align:left"><a href="https://book.douban.com/subject/35082292/" target="_blank" rel="noopener">学习究竟是什么</a></td><td style="text-align:left">万维钢</td><td style="text-align:left">2020.6~</td><td style="text-align:center">55%</td></tr><tr><td style="text-align:center">13</td><td style="text-align:left"><a href="https://book.douban.com/subject/24257229/" target="_blank" rel="noopener">鼠疫</a></td><td style="text-align:left">(法)阿尔贝·加缪</td><td style="text-align:left">2020.5~</td><td style="text-align:center">50%</td></tr><tr><td style="text-align:center">12</td><td style="text-align:left"><a href="https://book.douban.com/subject/26761696/" target="_blank" rel="noopener">精进-如何成为一个很厉害的人</a></td><td style="text-align:left">采铜</td><td style="text-align:left">2019.4</td><td style="text-align:center">15%</td></tr><tr><td style="text-align:center">11</td><td style="text-align:left">冥想</td><td style="text-align:left">斯瓦米·拉玛 (Swami Rama)</td><td style="text-align:left">2019.4</td><td style="text-align:center">10%</td></tr><tr><td style="text-align:center">10</td><td style="text-align:left">技术：如何用一年时间获得十年经验</td><td style="text-align:left">郝培强</td><td style="text-align:left">2018.11</td><td style="text-align:center">100%</td></tr><tr><td style="text-align:center">9</td><td style="text-align:left">习惯的力量</td><td style="text-align:left">［美］查尔斯·都希格【吴奕俊、陈丽丽、曹烨译】</td><td style="text-align:left">2018</td><td style="text-align:center">20%</td></tr><tr><td style="text-align:center">8</td><td style="text-align:left">深度工作</td><td style="text-align:left">［美］卡尔·纽波特【宋伟、后浪】</td><td style="text-align:left">2018</td><td style="text-align:center">70%</td></tr><tr><td style="text-align:center">7</td><td style="text-align:left">秒懂力</td><td style="text-align:left">唐文</td><td style="text-align:left">2018</td><td style="text-align:center">67%</td></tr><tr><td style="text-align:center">6</td><td style="text-align:left">微习惯</td><td style="text-align:left">［美］斯蒂芬·盖斯【桂君译】</td><td style="text-align:left">2018</td><td style="text-align:center">76%</td></tr><tr><td style="text-align:center">5</td><td style="text-align:left">刻意练习</td><td style="text-align:left">［美］安德森·艾利克森、罗伯特普尔【王正林译】</td><td style="text-align:left">2018</td><td style="text-align:center">22%</td></tr><tr><td style="text-align:center">4</td><td style="text-align:left">人类简史-从动物到上帝</td><td style="text-align:left">［以色列］尤瓦尔·赫拉利【林俊宏译】</td><td style="text-align:left">2018</td><td style="text-align:center">54%</td></tr><tr><td style="text-align:center">3</td><td style="text-align:left">如何高效学习</td><td style="text-align:left">［加］斯科特·扬【程冕译】</td><td style="text-align:left">2018</td><td style="text-align:center">54%</td></tr><tr><td style="text-align:center">2</td><td style="text-align:left">如何阅读一本书</td><td style="text-align:left">［加］莫提默·J. 艾德勒、查尔斯·范多伦【 郝明义、朱衣译】</td><td style="text-align:left">2018</td><td style="text-align:center">50%</td></tr><tr><td style="text-align:center">1</td><td style="text-align:left">好孩子：三分天注定，七分靠教育</td><td style="text-align:left">洪兰、尹建莉</td><td style="text-align:left">&lt;2016</td><td style="text-align:center">82%</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;一日不读书、不思考便觉自己在堕落&lt;br&gt;
    
    </summary>
    
    
      <category term="书单" scheme="http://www.iuwai.com/tags/%E4%B9%A6%E5%8D%95/"/>
    
  </entry>
  
  <entry>
    <title>xiaochao</title>
    <link href="http://www.iuwai.com/2018/03/25/xiaochao/"/>
    <id>http://www.iuwai.com/2018/03/25/xiaochao/</id>
    <published>2018-03-25T02:11:28.000Z</published>
    <updated>2020-09-05T08:33:13.965Z</updated>
    
    <content type="html"><![CDATA[<p>日常小小抄<br><a id="more"></a></p><h4 id="2019-6-26-14-26"><a href="#2019-6-26-14-26" class="headerlink" title="2019.6.26 14:26"></a>2019.6.26 14:26</h4><p>天地有大美，美的是自然；流水不争先，争的是滔滔不绝</p><h4 id="2019-6-25-14-48"><a href="#2019-6-25-14-48" class="headerlink" title="2019.6.25 14:48"></a>2019.6.25 14:48</h4><p>我本无意穿堂风， 偏偏孤倨引山洪</p><h4 id="2019-06-18-09-02"><a href="#2019-06-18-09-02" class="headerlink" title="2019.06.18 09:02"></a>2019.06.18 09:02</h4><p>倾听：倾听与听不同，倾听是解读别人所说信息的过程，包含听到、专注、理解、回应、记忆五大元素。可以获得更多信息，对对方有更多了解。倾听能让对方感觉到自己被尊重，所以才会跟你分享更多的信息。<br>倾听不仅仅只是听，还要思考，要思考更深层的原因，不要被表象所迷惑。</p><h4 id="2019-06-13-17-55"><a href="#2019-06-13-17-55" class="headerlink" title="2019.06.13 17:55"></a>2019.06.13 17:55</h4><p><a href="https://mp.weixin.qq.com/s?__biz=MzIzNzM5MTI0Nw==&amp;mid=2247491492&amp;idx=5&amp;sn=ff89fda8279741c86f61d51da7a972c9&amp;chksm=e8c80344dfbf8a52ec81d2ab216290d11ecf00c3255761a676b54bd75a837f4683cfdf77a219&amp;scene=0&amp;xtrack=1&amp;key=b0ebf1a5d52c1bb69fb06bc850c8f16b7a8b31c4c30dac1069cdbb9cbd7800680df64e4c487dd11c13db023f62a056d326ec185cf22da40f5b95cc43632442c15ee018aa2a07fff516c585dbefacda81&amp;ascene=1&amp;uin=MTQxMDYwNzEwMg%3D%3D&amp;devicetype=Windows+10&amp;version=62060833&amp;lang=zh_CN&amp;pass_ticket=o8%2BDH7X5izJrv5TEIiQCIHVApW8nc54nKIqNJF19l7IXFi8tp06NWD5Puk9fg6PU" target="_blank" rel="noopener">摘抄地址</a><br>上兵伐谋，不战而胜，冷静的把问题解决掉，才是解决争执的最高境界。<br>2：上兵伐谋<br>但是，为什么大多数人都做不到这一步呢？<br>吵架时真正的敌人不是吵架的对手，而是自己的情绪，藏在我们身体里的“情绪”，才是我们每个人最大的敌人。<br>也就是说我们是被自己的情绪牵着走的，吵架最后往往变成了同自己情绪斗争的过程。<br>人生最大的敌人是自己，战胜别人容易，战胜自己太难。<br>人一旦被情绪左右，心魔就会趁机而出，很多冲动行为就是这样导致的，一时的冲动造成终身后悔的事情比比皆是。<br>所以，在被激怒的时刻，千万不要当即回击，不妨先在内心里从1数到10，然后再去交流和沟通，这是个很好的办法。</p><p>3：收益最大化<br>和别人吵架过程中，最需要防范的一点是什么呢？<br>中国人斗争的哲学里最狠的一招是这样的：先站在道德制高点上打倒一个人，给她扣上一顶道德败坏的帽子，从人品上否定一个人，这样她所说的一切，做的一切辩驳都是苍白的。<br>这其实是兵法的上上策：诛人先诛心。<br>这一招用好了，可以直接把对方逼崩溃，有理说不清，越说越乱。<br>更有甚者，是先给对方扣上一顶帽子，然后尽情往对方身上泼脏水……<br>要是照这个节奏下去，对方就只剩下一个出路，那就是和你同归于尽。<br>因此，我们千万不要做这种泼妇式的人身攻击，但是当遇到这种攻击的时候，我们应该怎么做呢？<br>三十六计，走为上计。置之不理的最好的方式，就好像一条疯狗咬了你，你不能用嘴去咬它，你应该避开对方的纠缠，寻求对你利益最大化的解决方案，<br>能屈能伸是条龙，暂时的隐忍不代表认输，而是寻求可以一招制敌的最佳时机！<br>4：弱者易怒如虎，强者平静如水<br>真正的高手，从来不会和人吵架，因为他们太善于沟通。<br>沟通，是解决吵架的最好方案。<br>很多人会说，在那样的时刻已经无法做到沟通了。<br>首先，我们不能要求别人冷静又理性，我们要做的是让自己时刻保持镇定，我们说每一句话都要先在大脑里过滤一遍，想想这句话是否超出了事情本身，不要可只顾自己说出来痛快，就忽略他人的感受。</p><p>场景分析：当对方开始说：“你真自私！”。你如果直接反击：“那你呢？你又好到那边去？！”，这样会马上升级到人格斗争的节奏<br>应该静下心来问一下对方：“为什么你这么觉得，我做了什么事情让你感觉这样子？”然后仔细倾听对方发出的有效信息。<br>一个真正厉害的人，非常善于筛选出对方发出的有效信息，过滤并忽略掉对方情绪化的语言！<br>弱者易怒如虎，强者平静如水。对着别人大吼，是最无能的表现。<br>如果对方提出的事实，你觉得是错误的。你也应该要讲出真正的事实，当对方表示不满意，你一定要让对方提出具体不满意的地方，总之一切围绕矛盾本身去探讨，而不是给矛盾升级。<br>尊重对手是大格局表现其中之一<br>尊重你的对手，聆听对方的难处，站在对方角度考虑问题，当你做到了这一步，你就没有了对手，五湖四海皆朋友。<br>无敌，不是打败了所有人，而是没有一个人与你为敌。</p><h4 id="2019-05-29-13-39"><a href="#2019-05-29-13-39" class="headerlink" title="2019.05.29 13:39"></a>2019.05.29 13:39</h4><p>来都来了，多大点事，别太计较，都是亲戚，看我面子，大过节的，吃亏是福，为了你好</p><h4 id="2018-09-26-16-17"><a href="#2018-09-26-16-17" class="headerlink" title="2018.09.26 16:17"></a>2018.09.26 16:17</h4><p>人生没有白走的路，每一步都算数。</p><h4 id="2018-09-21-21-31"><a href="#2018-09-21-21-31" class="headerlink" title="2018.09.21 21:31"></a>2018.09.21 21:31</h4><p>总之，从今天开始努力，哪怕每天比前一天早睡10分钟，珍爱生命，远离熬夜<br>毕竟，有勇气结束今天，才能开启一个更美好的明天。<br>人生的核心问题，就是自律<br>生命是一个不可控的进度表，你永远不会知道，未来和意外哪个先来。<br>身体是每个人的神殿，不管里面供奉的是什么，都应该好好保持它的强韧、美丽和清洁。不要用熬夜来破坏他！<br>没有任何事，值得你用健康换。</p><h4 id="2018-09-12-12-51"><a href="#2018-09-12-12-51" class="headerlink" title="2018.09.12 12:51"></a>2018.09.12 12:51</h4><p>你觉得你在经历一片未知的黑暗领域，很无助很孤独很害怕，但是你要相信，在这片黑暗里有千万人与你同行，而每一个人都在努力想活下去。</p><h4 id="2018-03-25-10-15"><a href="#2018-03-25-10-15" class="headerlink" title="2018.03.25 10:15"></a>2018.03.25 10:15</h4><p>知世故而不世故，才是真正的少年。<br>被伤害过依然能倾心以赴赤诚相待，才是真正的少年。</p><hr><p>网上曾经流传一句话“中年男人不如狗”。<br>说得有理有据：</p><p>1.年龄逐渐增长，身体机能随之下降，多种病症出现。</p><p>2.他们在家中承担起抚养父母妻儿的责任，在社会上如果没有体面的工作就要忍气吞声。天能塌，他们不能。</p><p>3.男人年轻的时候都想着仗剑走天涯，惦记着诗和远方，后来工作太忙钱不够就没去。</p><p>4.生而为人，无法避免被“比较”。从小到大向来如此，小时候的敌人是别人家的孩子，长大之后是别人家的丈夫，再往后是别人家的父亲。</p><hr><p>知乎上也有这样一个问题：</p><p>“为什么那么多男人开车回家，到了楼下还要在车里坐好久？”</p><p>有一个回答获得了高分点赞：</p><p>“很多时候我也不想下车，因为那是一个分界点。在车上，一个人静一静，抽根烟，发会呆这个躯体属于自己；但推开车门，你就是柴米油盐，是父亲、是儿子、是老公，唯独不是你自己。我们把真实的自己藏在车里；打开车门出去，哪怕是哭着爬着，也只能把被人寄予厚望的身份扮演下去。”</p><hr><p>张泉灵 教育孩子，两件事优先级要靠前：<br>   原文地址：<a href="https://m.igetget.com/share/audio/aid/exAnd8uPMN9Zg00pSGg0" target="_blank" rel="noopener">https://m.igetget.com/share/audio/aid/exAnd8uPMN9Zg00pSGg0</a><br>1.孩子有没有情商，也就是孩子有没有认知自己的情绪和行为、认知周围人的情绪和行为，以及和别人相处的能力。<br>2.孩子能不能培养起属于自己的学习方法论，是否有一个知识框架。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;日常小小抄&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Django-route</title>
    <link href="http://www.iuwai.com/2018/03/10/Django-route/"/>
    <id>http://www.iuwai.com/2018/03/10/Django-route/</id>
    <published>2018-03-10T08:24:29.000Z</published>
    <updated>2020-09-05T08:33:13.965Z</updated>
    
    <content type="html"><![CDATA[<p>Django路由系统:动态路由、指定参数名、默认参数<br><a id="more"></a></p><h2 id="Django路由系统"><a href="#Django路由系统" class="headerlink" title="Django路由系统"></a>Django路由系统</h2><h3 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h3><p>urls.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> patterns, include,url</span><br><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> web.views <span class="keyword">import</span> index, login, list</span><br><span class="line">urlpatterns = patterns(<span class="string">''</span>,</span><br><span class="line">    url(<span class="string">r'^list/(\d*)/$'</span>, list),  <span class="comment">#一个参数</span></span><br><span class="line">    url(<span class="string">r'^list/(\d*)/(\d*)/$'</span>, list),  <span class="comment">#两个参数，按顺序获取</span></span><br><span class="line">    url(<span class="string">r'^list/(?P&lt;name&gt;\d*)/(?P&lt;id&gt;\d*)/$'</span>, list),  <span class="comment">#指定参数名,获取参数时名字必须为name, id</span></span><br><span class="line">    url(<span class="string">r'^list/(?P&lt;name&gt;\d*)/$'</span>, list, &#123;<span class="string">'id'</span>:<span class="number">222</span>&#125;),  <span class="comment">#默认参数值</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></p><p>views.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">list</span><span class="params">(request, id1, id2)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> id</span><br><span class="line">    <span class="keyword">print</span> id1, id2</span><br><span class="line">    <span class="keyword">return</span> HttpResponse()</span><br></pre></td></tr></table></figure></p><p>指定参数名：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">list</span><span class="params">(request, id, name)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> name, id</span><br><span class="line">    <span class="keyword">return</span> HttpResponse()</span><br></pre></td></tr></table></figure></p><p>请求链接：<a href="http://localhost:9000/list/100" target="_blank" rel="noopener">http://localhost:9000/list/100</a>         #一个参数<br>请求链接：<a href="http://localhost:9000/list/100/1000" target="_blank" rel="noopener">http://localhost:9000/list/100/1000</a>    #两个参数<br>注：请求链接最后必须要加/,如果不加，urls配置中必须要加上终止符：/$,这样请求时会自动加上/</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Django路由系统:动态路由、指定参数名、默认参数&lt;br&gt;
    
    </summary>
    
      <category term="Python" scheme="http://www.iuwai.com/categories/Python/"/>
    
    
      <category term="Django" scheme="http://www.iuwai.com/tags/Django/"/>
    
      <category term="路由系统" scheme="http://www.iuwai.com/tags/%E8%B7%AF%E7%94%B1%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7.4 update ntp</title>
    <link href="http://www.iuwai.com/2018/02/13/CentOS7-4-update-ntp/"/>
    <id>http://www.iuwai.com/2018/02/13/CentOS7-4-update-ntp/</id>
    <published>2018-02-13T06:23:08.000Z</published>
    <updated>2020-09-05T08:33:13.965Z</updated>
    
    <content type="html"><![CDATA[<p>CentOS6.8 x86_64升级ntp-4.2.8p9.tar.gz<br><a id="more"></a></p><p>#准备工作</p><h2 id="安装依赖包"><a href="#安装依赖包" class="headerlink" title="安装依赖包"></a>安装依赖包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ openssl-devel libstdc++* libcap*</span><br></pre></td></tr></table></figure><h2 id="备份旧版本的配置文件"><a href="#备份旧版本的配置文件" class="headerlink" title="备份旧版本的配置文件"></a>备份旧版本的配置文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cp -ar /etc/ntp /etc/ntp.bak</span><br><span class="line">cp /etc/ntp.conf /etc/ntp.conf.bak</span><br><span class="line">cp /etc/init.d/ntpd /etc/init.d/ntpd.bak</span><br><span class="line">cp /etc/sysconfig/ntpd /etc/sysconfig/ntpd.bak</span><br><span class="line">cp /etc/sysconfig/ntpdate /etc/sysconfig/ntpdate.bak</span><br></pre></td></tr></table></figure><h2 id="卸载原ntpd服务"><a href="#卸载原ntpd服务" class="headerlink" title="卸载原ntpd服务"></a>卸载原ntpd服务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y erase ntp ntpdate</span><br></pre></td></tr></table></figure><h1 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h1><h2 id="configure"><a href="#configure" class="headerlink" title="./configure"></a>./configure</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf ntp-4.2.8p10.tar.gz</span><br><span class="line"><span class="built_in">cd</span> ntp-4.2.8p10</span><br><span class="line">./configure --prefix=/usr --bindir=/usr/sbin --sysconfdir=/etc --<span class="built_in">enable</span>-linuxcaps --with-lineeditlibs=readline --docdir=/usr/share/doc/ntp-4.2.8p9 --<span class="built_in">enable</span>-all-clocks --<span class="built_in">enable</span>-parse-clocks --<span class="built_in">enable</span>-clockctl</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h2 id="创建配置"><a href="#创建配置" class="headerlink" title="创建配置"></a>创建配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/init.d/ntpd.bak /etc/init.d/ntpd</span><br><span class="line">cp /etc/sysconfig/ntpd.bak /etc/sysconfig/ntpd</span><br><span class="line">cp /etc/sysconfig/ntpdate.bak /etc/sysconfig/ntpdate</span><br><span class="line">mv /etc/ntp.bak /etc/ntp</span><br><span class="line">cp /etc/ntp.conf.bak /etc/ntp.conf</span><br></pre></td></tr></table></figure><h2 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ntp.conf</span><br></pre></td></tr></table></figure><h2 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service ntpd start</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CentOS6.8 x86_64升级ntp-4.2.8p9.tar.gz&lt;br&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://www.iuwai.com/categories/Linux/"/>
    
    
      <category term="CentOS7.4" scheme="http://www.iuwai.com/tags/CentOS7-4/"/>
    
      <category term="ntp" scheme="http://www.iuwai.com/tags/ntp/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7.4 install vsftp</title>
    <link href="http://www.iuwai.com/2018/02/09/CentOS7-4-install-vsftp/"/>
    <id>http://www.iuwai.com/2018/02/09/CentOS7-4-install-vsftp/</id>
    <published>2018-02-09T08:37:03.000Z</published>
    <updated>2020-09-05T08:33:13.965Z</updated>
    
    <content type="html"><![CDATA[<p>CentOS7.4安装vsftp及配置<br>vsftp版本：vsftpd-3.0.2-22.el7.x86_64<br><a id="more"></a></p><h1 id="安装vsftpd"><a href="#安装vsftpd" class="headerlink" title="安装vsftpd"></a>安装vsftpd</h1><p>查看是否已经安装vsftpd<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep vsftpd</span><br></pre></td></tr></table></figure></p><p>如果没有，就安装，并设置开机启动<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install vsftpd</span><br><span class="line">chkconfig vsftpd on</span><br></pre></td></tr></table></figure></p><p>当前yum安装的FTP版本为：vsftpd-3.0.2-22.el7.x86_64</p><h1 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h1><p>所谓虚拟用户就是没有使用真实的帐户，只是通过映射到真实帐户和设置权限的目的。虚拟用户不能登录CentOS系统。<br>修改配置文件：<br>打开/etc/vsftpd/vsftpd.conf，做如下配置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">listen=YES</span><br><span class="line">anonymous_enable=NO //设定不允许匿名访问</span><br><span class="line">dirmessage_enable=YES</span><br><span class="line">allow_writeable_chroot=YES</span><br><span class="line"><span class="comment">#以下两行设置作用为启用日志</span></span><br><span class="line">dual_log_enable=YES</span><br><span class="line">vsftpd_log_file=/var/<span class="built_in">log</span>/vsftpd.log</span><br><span class="line">xferlog_std_format=YES</span><br><span class="line">chroot_local_user=YES</span><br><span class="line">guest_enable=YES</span><br><span class="line">guest_username=admin</span><br><span class="line">user_config_dir=/etc/vsftpd/vuser_conf //设定虚拟用户个人vsftp的CentOS FTP服务文件存放路径。存放虚拟用户个性的CentOS FTP服务文件(配置文件名=虚拟用户名</span><br><span class="line">pam_service_name=vsftpd //PAM认证文件名。PAM将根据/etc/pam.d/vsftpd进行认证</span><br><span class="line">local_enable=YES</span><br><span class="line">accept_timeout=60</span><br><span class="line">connect_timeout=60</span><br><span class="line">idle_session_timeout=60</span><br><span class="line">data_connection_timeout=120</span><br><span class="line"><span class="comment">#chown_uploads=YES</span></span><br><span class="line"><span class="comment">#chown_username=admin</span></span><br><span class="line"><span class="comment">#pasv_enable=YES</span></span><br><span class="line"><span class="comment">#pasv_max_port=60000</span></span><br><span class="line"><span class="comment">#pasv_min_port=20000</span></span><br></pre></td></tr></table></figure></p><p>经验证，FTP3.0.2版本必须加参数：allow_writeable_chroot=YES，6.8默认安装vsftpd-2.2.2-13.el6_6.1.x86_64不加也能生效，如果3.0.2不加此参数会报如下错误：<br>500 OOPS: vsftpd: refusing to run with writable root inside chroot()<br>根本原因在于，从vsftpd_2.3.5版开始，取消了根目录的可写权限。因此，网上的普遍解决方案是以下两种：</p><h2 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod a-w /vaf/ftp</span><br></pre></td></tr></table></figure><h2 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h2><p>vim /etc/vsftpd.conf add the following<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allow_writeable_chroot=YES</span><br></pre></td></tr></table></figure></p><p>经验证，如果加上参数allow_writeable_chroot，即使去掉参数chroot_local_user=YES，也可正常访问。<br>进行认证：<br>首先，安装Berkeley DB工具，很多人找不到db_load的问题就是没有安装这个包。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install db4 db4-utils</span><br></pre></td></tr></table></figure></p><p>然后，创建用户密码文本/etc/vsftpd/vuser_passwd.txt ，注意奇行是用户名，偶行是密码<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span></span><br><span class="line">123456</span><br></pre></td></tr></table></figure></p><p>接着，生成虚拟用户认证的db文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db_load -T -t <span class="built_in">hash</span> -f /etc/vsftpd/vuser_passwd.txt /etc/vsftpd/vuser_passwd.db</span><br></pre></td></tr></table></figure></p><p>随后，编辑认证文件/etc/pam.d/vsftpd，全部注释掉原来语句，再增加以下两句：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">auth required pam_userdb.so db=/etc/vsftpd/vuser_passwd</span><br><span class="line">account required pam_userdb.so db=/etc/vsftpd/vuser_passwd</span><br></pre></td></tr></table></figure></p><p>mkdir /etc/vsftpd/vuser_conf/<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/vsftpd/vuser_conf/<span class="built_in">test</span> //文件名等于vuser_passwd.txt里面的账户名，否则下面设置无效</span><br><span class="line"></span><br><span class="line">write_enable=YES //可写</span><br><span class="line">anon_world_readable_only=NO</span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">anon_mkdir_write_enable=YES</span><br><span class="line">anon_other_write_enable=YES</span><br><span class="line">local_root=/httx/run/appdown/paasftpuser /虚拟用户根目录,根据实际情况修改</span><br></pre></td></tr></table></figure></p><h4 id="设置Selinux"><a href="#设置Selinux" class="headerlink" title="设置Selinux"></a>设置Selinux</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setsebool -P ftp_home_dir=1   //设置ftp可以使用home目录</span><br><span class="line">sersebool -P allow_ftpd_full_access=1 //设置ftp用户可以有所有权限</span><br></pre></td></tr></table></figure><p>设置FTP根目录权限<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /ftp/www   //创建目录</span><br><span class="line">chmod R 755 /ftp</span><br><span class="line">chmod R 750 /ftp/www</span><br></pre></td></tr></table></figure></p><p>ftp访问目录权限尽量最小</p><h4 id="设置防火墙"><a href="#设置防火墙" class="headerlink" title="设置防火墙"></a>设置防火墙</h4><p>打开/etc/sysconfig/iptables<br>在“-A INPUT –m state –state NEW –m tcp –p –dport 22 –j ACCEPT”，下添加：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-A INPUT -m state --state NEW -m tcp -p -dport 21 -j ACCEPT</span><br></pre></td></tr></table></figure></p><p>然后保存，并关闭该文件，在终端内运行下面的命令，刷新防火墙配置：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service iptables restart</span><br></pre></td></tr></table></figure></p><p>OK，FTP搭建完成！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CentOS7.4安装vsftp及配置&lt;br&gt;vsftp版本：vsftpd-3.0.2-22.el7.x86_64&lt;br&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://www.iuwai.com/categories/Linux/"/>
    
    
      <category term="CentOS7.4" scheme="http://www.iuwai.com/tags/CentOS7-4/"/>
    
      <category term="vsftp" scheme="http://www.iuwai.com/tags/vsftp/"/>
    
  </entry>
  
  <entry>
    <title>OpenSSH Update</title>
    <link href="http://www.iuwai.com/2018/02/09/OpenSSH-Update/"/>
    <id>http://www.iuwai.com/2018/02/09/OpenSSH-Update/</id>
    <published>2018-02-09T07:37:17.000Z</published>
    <updated>2020-09-05T08:33:13.965Z</updated>
    
    <content type="html"><![CDATA[<p>由于公司安全需要，OpenSSH要加固，需升级至当前最新版本OpenSSH_7.6p1<br>环境：CentOS6.8 x64<br><a id="more"></a></p><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h2 id="下载相关软件包"><a href="#下载相关软件包" class="headerlink" title="下载相关软件包"></a>下载相关软件包</h2><p>OpenSSH需要依赖ZLIB和OpenSSL，因此需要从官网下载三者的源码包。需要注意的是：OpenSSH最新版7.4p1依赖的OpenSSL版本为1.0.2k，而不是其最新版1.1.0e（使用此版会升级失败）,ZLIB可以使用最新版1.2.11。CentOS6.8自带的zlib版本为1.2.3，也可不进行升级。 三者源码下载地址：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://www.zlib.net/</span><br><span class="line">http://www.openssl.org/</span><br><span class="line">http://www.openssh.org/</span><br></pre></td></tr></table></figure></p><p>或者使用我准备好的包：<br><a href="https://pan.baidu.com/s/1PzuK3FGVPLZuWvVvqJgaIQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1PzuK3FGVPLZuWvVvqJgaIQ</a></p><h2 id="查看系统当前软件版本"><a href="#查看系统当前软件版本" class="headerlink" title="查看系统当前软件版本"></a>查看系统当前软件版本</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -q zlib</span><br><span class="line">openssl version</span><br><span class="line">ssh -V</span><br></pre></td></tr></table></figure><h2 id="安装telnet服务并启用"><a href="#安装telnet服务并启用" class="headerlink" title="安装telnet服务并启用"></a>安装telnet服务并启用</h2><p>因升级OpenSSH过程中需要卸载现有OpenSSH, 因此为了保持服务器的远程连接可用，需要启用telnet服务作为替代，如升级出现问题，也可通过telnet登录服务器进行回退。</p><h3 id="A、安装telnet服务"><a href="#A、安装telnet服务" class="headerlink" title="A、安装telnet服务"></a>A、安装telnet服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install telnet-server*</span><br></pre></td></tr></table></figure><h3 id="B、启用telnet"><a href="#B、启用telnet" class="headerlink" title="B、启用telnet"></a>B、启用telnet</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">先关闭防火墙，否则telnet可能无法连接</span><br><span class="line">service iptables stop</span><br><span class="line">chkconfig iptables off</span><br><span class="line">vi /etc/xinetd.d/telnet                 <span class="comment">#将其中disable字段的yes改为no以启用telnet服务</span></span><br><span class="line">mv /etc/securetty /etc/securetty.old    <span class="comment">#允许root用户通过telnet登录</span></span><br><span class="line">service xinetd start                    <span class="comment">#启动telnet服务</span></span><br><span class="line">chkconfig xinetd on                     <span class="comment">#使telnet服务开机启动，避免升级过程中服务器意外重启后无法远程登录系统</span></span><br><span class="line">telnet [ip]                             <span class="comment">#新开启一个远程终端以telnet登录验证是否成功启用</span></span><br></pre></td></tr></table></figure><h2 id="安装编译所需工具包"><a href="#安装编译所需工具包" class="headerlink" title="安装编译所需工具包"></a>安装编译所需工具包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc pam-devel zlib-devel</span><br></pre></td></tr></table></figure><h1 id="正式升级"><a href="#正式升级" class="headerlink" title="正式升级"></a>正式升级</h1><h2 id="升级ZLIB"><a href="#升级ZLIB" class="headerlink" title="升级ZLIB"></a>升级ZLIB</h2><h3 id="A、解压zlib-1-2-11源码并编译"><a href="#A、解压zlib-1-2-11源码并编译" class="headerlink" title="A、解压zlib_1.2.11源码并编译"></a>A、解压zlib_1.2.11源码并编译</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf zlib-1.2.11.tar.gz</span><br><span class="line"><span class="built_in">cd</span> zlib-1.2.11</span><br><span class="line">CFLAGS=<span class="string">'-mstackrealign -fPIC -O3'</span> ./configure --prefix=/usr     //如果不加【CFLAGS=<span class="string">'-mstackrealign -fPIC -O3'</span>】这一段配置后面安装OpenSSH时会报错。</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="B、卸载当前zlib"><a href="#B、卸载当前zlib" class="headerlink" title="B、卸载当前zlib"></a>B、卸载当前zlib</h3><p>注意：此步骤必须在步骤A执行完毕后再执行，否则先卸载zlib后，/lib64/目录下的zlib相关库文件会被删除，步骤A编译zlib会失败。（补救措施：从其他相同系统的服务器上复制/lib64、/usr/lib和/usr/lib64目录下的libcrypto.so.10、libssl.so.10、libz.so.1、libz.so.1.2.3四个文件到相应目录即可。可通过whereis、locate或find命令找到这些文件的位置）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -e --nodeps zlib</span><br></pre></td></tr></table></figure><h3 id="C、安装之前编译好的zlib"><a href="#C、安装之前编译好的zlib" class="headerlink" title="C、安装之前编译好的zlib"></a>C、安装之前编译好的zlib</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在zlib编译目录执行如下命令</span></span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="D、共享库注册"><a href="#D、共享库注册" class="headerlink" title="D、共享库注册"></a>D、共享库注册</h3><p>zlib安装完成后，会在/usr/lib目录中生产zlib相关库文件，需要将这些共享库文件注册到系统中。</p><p><font color="#FF6600">建议用这种方式:</font><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ln -s  /usr/lib/libz.so.1 libz.so.1.2.11</span><br><span class="line">ln -s  /usr/lib/libz.so libz.so.1.2.11</span><br><span class="line">ln -s  /usr/lib/libz.so.1 /lib/libz.so.1</span><br><span class="line">rm -f /usr/lib64/libz.so                                  //若没有删除,则openssl编译失败.</span><br><span class="line">ln -s  /usr/lib/libz.so /usr/lib64/libz.so</span><br><span class="line">ln -s  /usr/lib64/libz.so ../../lib64/libz.so.1.2.11   //64位系统必须修改这个</span><br><span class="line">ldconfig</span><br></pre></td></tr></table></figure></p><p><font color="#FF6600"><strong>或者</strong></font>采用如下方式也可：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">'/usr/lib'</span> &gt;&gt; /etc/ld.so.conf</span><br><span class="line">ldconfig                    <span class="comment">#更新共享库cache</span></span><br></pre></td></tr></table></figure></p><h2 id="升级OpenSSL"><a href="#升级OpenSSL" class="headerlink" title="升级OpenSSL"></a>升级OpenSSL</h2><p>官方升级文档：<a href="http://www.linuxfromscratch.org/blfs/view/cvs/postlfs/openssl.html" target="_blank" rel="noopener">http://www.linuxfromscratch.org/blfs/view/cvs/postlfs/openssl.html</a></p><h3 id="A、备份当前openssl"><a href="#A、备份当前openssl" class="headerlink" title="A、备份当前openssl"></a>A、备份当前openssl</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">find / -name openssl</span><br><span class="line">/etc/pki/ca-trust/extracted/openssl</span><br><span class="line">/usr/bin/openssl</span><br><span class="line">/usr/lib64/openssl</span><br><span class="line">/usr/include/openssl</span><br><span class="line"></span><br><span class="line">mv /usr/lib64/openssl /usr/lib64/openssl.old</span><br><span class="line">mv /usr/bin/openssl  /usr/bin/openssl.old</span><br><span class="line">mv /etc/pki/ca-trust/extracted/openssl  /etc/pki/ca-trust/extracted/openssl.old</span><br><span class="line">mv /usr/include/openssl /usr/include/openssl.old</span><br></pre></td></tr></table></figure><p>如下两个库文件必须先备份，因系统内部分工具（如yum、wget等）依赖此库，而新版OpenSSL不包含这两个库<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/lib64/libcrypto.so.10  /usr/lib64/libcrypto.so.10.old</span><br><span class="line">cp /usr/lib64/libssl.so.10  /usr/lib64/libssl.so.10.old</span><br></pre></td></tr></table></figure></p><h3 id="B、卸载当前openssl"><a href="#B、卸载当前openssl" class="headerlink" title="B、卸载当前openssl"></a>B、卸载当前openssl</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep openssl</span><br><span class="line">openssl-1.0.1e-42.el6.x86_64</span><br><span class="line"></span><br><span class="line">rpm -e --nodeps openssl-1.0.1e-42.el6.x86_64</span><br><span class="line">rpm -qa | grep openssl</span><br><span class="line"><span class="comment">#或者直接执行此命令：</span></span><br><span class="line">rpm -qa |grep openssl|xargs -i rpm -e --nodeps &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="C、解压openssl-1-0-2k源码并编译安装"><a href="#C、解压openssl-1-0-2k源码并编译安装" class="headerlink" title="C、解压openssl_1.0.2k源码并编译安装"></a>C、解压openssl_1.0.2k源码并编译安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf openssl-1.0.2k.tar.gz</span><br><span class="line"><span class="built_in">cd</span> openssl-1.0.2k</span><br><span class="line">./config --prefix=/usr --openssldir=/etc/ssl --shared zlib    <span class="comment">#必须加上--shared，否则编译时会找不到新安装的openssl的库而报错</span></span><br><span class="line">make</span><br><span class="line">make <span class="built_in">test</span>                            <span class="comment">#必须执行这一步结果为pass才能继续，否则即使安装完成，ssh也无法使用</span></span><br><span class="line">make install</span><br><span class="line">openssl version -a                   <span class="comment">#查看是否升级成功</span></span><br></pre></td></tr></table></figure><p>make test正确输出：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">*---- START OF RECORD ----</span><br><span class="line">** Record Content-type: 22</span><br><span class="line">** Record Version: fefd</span><br><span class="line">** Record Epoch: 1</span><br><span class="line">** Record Sequence: 000000000000</span><br><span class="line">** Record Length: 64</span><br><span class="line">**---- START OF HANDSHAKE MESSAGE FRAGMENT ----</span><br><span class="line">**---- HANDSHAKE MESSAGE FRAGMENT ENCRYPTED ----</span><br><span class="line">*---- END OF RECORD ----</span><br><span class="line">---- END OF PACKET ----</span><br><span class="line">PASS</span><br><span class="line">test_bad_dtls</span><br><span class="line">../util/shlib_wrap.sh ./bad_dtls_test</span><br><span class="line">make[1]: Leaving directory `/tmp/openssl-1.0.2m/<span class="built_in">test</span><span class="string">'</span></span><br><span class="line"><span class="string">OPENSSL_CONF=apps/openssl.cnf util/opensslwrap.sh version -a</span></span><br><span class="line"><span class="string">OpenSSL 1.0.2m  2 Nov 2017</span></span><br><span class="line"><span class="string">built on: reproducible build, date unspecified</span></span><br><span class="line"><span class="string">platform: linux-x86_64</span></span><br><span class="line"><span class="string">options:  bn(64,64) rc4(16x,int) des(idx,cisc,16,int) idea(int) blowfish(idx)</span></span><br><span class="line"><span class="string">compiler: gcc -I. -I.. -I../include  -fPIC -DOPENSSL_PIC -DZLIB -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -Wa,--noexecstack -m64 -DL_ENDIAN -O3 -Wall -DOPENSSL_IA32_SSE2 -            </span></span><br><span class="line"><span class="string">DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DRC4_ASM -DSHA1_ASM -DSHA256_ASM -    </span></span><br><span class="line"><span class="string">DSHA512_ASM -DMD5_ASM -DAES_ASM -DVPAES_ASM -DBSAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM -DECP_NISTZ256_ASM</span></span><br><span class="line"><span class="string">OPENSSLDIR: "/etc/ssl"</span></span><br></pre></td></tr></table></figure></p><h3 id="D、恢复共享库"><a href="#D、恢复共享库" class="headerlink" title="D、恢复共享库"></a>D、恢复共享库</h3><p>由于OpenSSL_1.0.2k不提供libcrypto.so.10和libssl.so.10这两个库，而yum、wget等工具又依赖此库，因此需要将先前备份的这两个库进行恢复，其他的可视情况考虑是否恢复。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mv /usr/lib64/libcrypto.so.10.old  /usr/lib64/libcrypto.so.10</span><br><span class="line">mv /usr/lib64/libssl.so.10.old  /usr/lib64/libssl.so.10</span><br></pre></td></tr></table></figure></p><p>返回值：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mv  /usr/lib64/libcrypto.so.10.old  /usr/lib64/libcrypto.so.10</span><br><span class="line">mv: overwrite `/usr/lib64/libcrypto.so.10<span class="string">'? y</span></span><br><span class="line"><span class="string">mv  /usr/lib64/libssl.so.10.old  /usr/lib64/libssl.so.10</span></span><br><span class="line"><span class="string">mv: overwrite `/usr/lib64/libssl.so.10'</span>? y</span><br></pre></td></tr></table></figure></p><h2 id="升级OpenSSH"><a href="#升级OpenSSH" class="headerlink" title="升级OpenSSH"></a>升级OpenSSH</h2><p>官方升级文档：<a href="http://www.linuxfromscratch.org/blfs/view/svn/postlfs/openssh.html" target="_blank" rel="noopener">http://www.linuxfromscratch.org/blfs/view/svn/postlfs/openssh.html</a></p><h3 id="A、备份当前openssh"><a href="#A、备份当前openssh" class="headerlink" title="A、备份当前openssh"></a>A、备份当前openssh</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv /etc/ssh /etc/ssh.old</span><br></pre></td></tr></table></figure><h3 id="B、卸载当前openssh"><a href="#B、卸载当前openssh" class="headerlink" title="B、卸载当前openssh"></a>B、卸载当前openssh</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep openssh</span><br><span class="line">openssh-clients-5.3p1-111.el6.x86_64</span><br><span class="line">openssh-server-5.3p1-111.el6.x86_64</span><br><span class="line">openssh-5.3p1-111.el6.x86_64</span><br><span class="line">openssh-askpass-5.3p1-111.el6.x86_64</span><br><span class="line"></span><br><span class="line">rpm -e --nodeps openssh-5.3p1-111.el6.x86_64</span><br><span class="line">rpm -e --nodeps openssh-server-5.3p1-111.el6.x86_64</span><br><span class="line">rpm -e --nodeps openssh-clients-5.3p1-111.el6.x86_64</span><br><span class="line">rpm -e --nodeps openssh-askpass-5.3p1-111.el6.x86_64</span><br><span class="line">rpm -qa | grep openssh</span><br><span class="line"><span class="comment">#或者直接执行此命令：</span></span><br><span class="line">rpm -qa |grep openssh|xargs -i rpm -e --nodeps &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="C、openssh安装前环境配置"><a href="#C、openssh安装前环境配置" class="headerlink" title="C、openssh安装前环境配置"></a>C、openssh安装前环境配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">install  -v -m700 -d /var/lib/sshd</span><br><span class="line">chown  -v root:sys /var/lib/sshd</span><br><span class="line">groupadd -g 50 sshd</span><br><span class="line">useradd  -c <span class="string">'sshd PrivSep'</span> -d /var/lib/sshd -g sshd -s /bin/<span class="literal">false</span> -u 50 sshd</span><br></pre></td></tr></table></figure><h3 id="D、解压openssh-7-4p1源码并编译安装"><a href="#D、解压openssh-7-4p1源码并编译安装" class="headerlink" title="D、解压openssh_7.4p1源码并编译安装"></a>D、解压openssh_7.4p1源码并编译安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf openssh-7.4p1.tar.gz</span><br><span class="line"><span class="built_in">cd</span> openssh-7.4p1</span><br><span class="line">./configure --prefix=/usr  --sysconfdir=/etc/ssh  --with-md5-passwords  --with-pam  --with-zlib --with-openssl-includes=/usr --with-privsep-path=/var/lib/sshd</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="E、openssh安装后环境配置"><a href="#E、openssh安装后环境配置" class="headerlink" title="E、openssh安装后环境配置"></a>E、openssh安装后环境配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在openssh编译目录执行如下命令</span></span><br><span class="line">install -v -m755    contrib/ssh-copy-id /usr/bin</span><br><span class="line">install -v -m644    contrib/ssh-copy-id.1 /usr/share/man/man1</span><br><span class="line">install -v -m755 -d /usr/share/doc/openssh-7.4p1</span><br><span class="line">install -v -m644    INSTALL LICENCE OVERVIEW README* /usr/share/doc/openssh-7.4p1</span><br><span class="line">ssh -V              <span class="comment">#验证是否升级成功</span></span><br></pre></td></tr></table></figure><h3 id="F、启用OpenSSH服务"><a href="#F、启用OpenSSH服务" class="headerlink" title="F、启用OpenSSH服务"></a>F、启用OpenSSH服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在openssh编译目录执行如下目录</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'X11Forwarding yes'</span> &gt;&gt; /etc/ssh/sshd_config</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"PermitRootLogin yes"</span> &gt;&gt; /etc/ssh/sshd_config   <span class="comment">#允许root用户通过ssh登录</span></span><br><span class="line">cp -p contrib/redhat/sshd.init /etc/init.d/sshd</span><br><span class="line">chmod +x /etc/init.d/sshd</span><br><span class="line">chkconfig  --add  sshd</span><br><span class="line">chkconfig  sshd  on</span><br><span class="line">chkconfig  --list  sshd</span><br><span class="line">service sshd restart</span><br></pre></td></tr></table></figure><p>注意：如果升级操作一直是在ssh远程会话中进行的，上述sshd服务重启命令可能导致会话断开并无法使用ssh再行登入（即ssh未能成功重启），此时需要通过telnet登入再执行sshd服务重启命令。</p><h3 id="G、修改文件-etc-ssh-sshd-config"><a href="#G、修改文件-etc-ssh-sshd-config" class="headerlink" title="G、修改文件/etc/ssh/sshd_config"></a>G、修改文件/etc/ssh/sshd_config</h3><p>由于加固后的ssh（ssh6.7以上）屏蔽了不安全算法，需要在/etc/ssh/sshd_config最后加上如下信息，不然Python模块paromiko，无法连接加固后的机器：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1</span><br></pre></td></tr></table></figure></p><h2 id="善后工作"><a href="#善后工作" class="headerlink" title="善后工作"></a>善后工作</h2><p>新开启远程终端以ssh [ip]登录系统，确认一切正常升级成功后，只需关闭telnet服务以保证系统安全性即可。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mv /etc/securetty.old /etc/securetty</span><br><span class="line">chkconfig  xinetd off</span><br><span class="line">service xinetd stop</span><br></pre></td></tr></table></figure></p><p>如有必要，可重新开启防火墙<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service iptables start</span><br><span class="line">chkconfig iptables on</span><br></pre></td></tr></table></figure></p><p>如需还原之前的ssh配置信息，可直接删除升级后的配置信息，恢复备份。<br>ssh大版本升级尽量不要删除新生成的ssh文件，将原文件与新生成文件都保留一份。<br>原版本：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -V</span><br><span class="line">OpenSSH_5.3p1, OpenSSL 1.0.1e-fips 11 Feb 2013</span><br></pre></td></tr></table></figure></p><p>升级至：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OpenSSH_7.4p1, OpenSSL 1.0.2n  7 Dec 2017</span><br></pre></td></tr></table></figure></p><p><font color="#FF6600">后如果执行<strong>以下操作</strong>，会导致<strong>无法登陆</strong>。</font></p><p><font color="#FF6600" size="16"><strong>正确做法：</strong>使用此次安装好的文件/etc/ssh，不要用原文件覆盖！不然ssh无法使用。</font><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#！！！！！！千万不要执行如下命令！！！！！！</span></span><br><span class="line"><span class="comment">#rm -rf /etc/ssh</span></span><br><span class="line"><span class="comment">#mv /etc/ssh.old /etc/ssh</span></span><br></pre></td></tr></table></figure></p><h2 id="遇到的错误-1："><a href="#遇到的错误-1：" class="headerlink" title="遇到的错误-1："></a>遇到的错误-1：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">make[2]: Entering directory `/tmp/openssl-1.0.2m<span class="string">'</span></span><br><span class="line"><span class="string">[ -z "" ] || gcc -fPIC -DOPENSSL_PIC -DZLIB -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -Wa,--noexecstack -m64 -DL_ENDIAN -O3 -Wall -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DRC4_ASM -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DAES_ASM -DVPAES_ASM -DBSAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM -DECP_NISTZ256_ASM -Iinclude \</span></span><br><span class="line"><span class="string">            -DFINGERPRINT_PREMAIN_DSO_LOAD -o fips_premain_dso  \</span></span><br><span class="line"><span class="string">            fips_premain.c fipscanister.o \</span></span><br><span class="line"><span class="string">            libcrypto.a -ldl -lz</span></span><br><span class="line"><span class="string">make[3]: Entering directory `/tmp/openssl-1.0.2m'</span></span><br><span class="line">make[4]: Entering directory `/tmp/openssl-1.0.2m<span class="string">'</span></span><br><span class="line"><span class="string">/usr/bin/ld: /usr/lib/gcc/x86_64-redhat-linux/4.4.7/../../../../lib64/libz.a(deflate.o): relocation R_X86_64_32S against `_length_code'</span> can not be used when making a shared object; recompile with -fPIC</span><br><span class="line">/usr/lib/gcc/x86_64-redhat-linux/4.4.7/../../../../lib64/libz.a: could not <span class="built_in">read</span> symbols: Bad value</span><br><span class="line">collect2: ld returned 1 <span class="built_in">exit</span> status</span><br><span class="line">make[4]: *** [link_a.gnu] Error 1</span><br><span class="line">make[4]: Leaving directory `/tmp/openssl-1.0.2m<span class="string">'</span></span><br><span class="line"><span class="string">make[3]: *** [do_linux-shared] Error 2</span></span><br><span class="line"><span class="string">make[3]: Leaving directory `/tmp/openssl-1.0.2m'</span></span><br><span class="line">make[2]: *** [libcrypto.so.1.0.0] Error 2</span><br><span class="line">make[2]: Leaving directory `/tmp/openssl-1.0.2m<span class="string">'</span></span><br><span class="line"><span class="string">make[1]: *** [shared] Error 2</span></span><br><span class="line"><span class="string">make[1]: Leaving directory `/tmp/openssl-1.0.2m/crypto'</span></span><br><span class="line">make: *** [build_crypto] Error 1</span><br></pre></td></tr></table></figure><p>解决办法：zlib编译时添加configure前面的配置：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CFLAGS=<span class="string">'-mstackrealign -fPIC -O3'</span> ./configure --prefix=/usr</span><br></pre></td></tr></table></figure></p><h2 id="遇到的报错-2："><a href="#遇到的报错-2：" class="headerlink" title="遇到的报错-2："></a>遇到的报错-2：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">make[2]: Entering directory `/tmp/openssl-1.0.2m<span class="string">'</span></span><br><span class="line"><span class="string">[ -z "" ] || gcc -fPIC -DOPENSSL_PIC -DZLIB -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -Wa,--noexecstack -m64 -DL_ENDIAN -O3 -Wall -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -        DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DRC4_ASM -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -    DAES_ASM -DVPAES_ASM -DBSAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM -DECP_NISTZ256_ASM -Iinclude \</span></span><br><span class="line"><span class="string">            -DFINGERPRINT_PREMAIN_DSO_LOAD -o fips_premain_dso  \</span></span><br><span class="line"><span class="string">            fips_premain.c fipscanister.o \</span></span><br><span class="line"><span class="string">            libcrypto.a -ldl -lz</span></span><br><span class="line"><span class="string">make[3]: Entering directory `/tmp/openssl-1.0.2m'</span></span><br><span class="line">make[4]: Entering directory `/tmp/openssl-1.0.2m<span class="string">'</span></span><br><span class="line"><span class="string">/usr/bin/ld: error while loading shared libraries: libz.so.1: cannot open shared object file: No such file or directory</span></span><br><span class="line"><span class="string">collect2: ld returned 127 exit status</span></span><br><span class="line"><span class="string">make[4]: *** [link_a.gnu] Error 1</span></span><br><span class="line"><span class="string">make[4]: Leaving directory `/tmp/openssl-1.0.2m'</span></span><br><span class="line">make[3]: *** [do_linux-shared] Error 2</span><br><span class="line">make[3]: Leaving directory `/tmp/openssl-1.0.2m<span class="string">'</span></span><br><span class="line"><span class="string">make[2]: *** [libcrypto.so.1.0.0] Error 2</span></span><br><span class="line"><span class="string">make[2]: Leaving directory `/tmp/openssl-1.0.2m'</span></span><br><span class="line">make[1]: *** [shared] Error 2</span><br><span class="line">make[1]: Leaving directory `/tmp/openssl-1.0.2m/crypto<span class="string">'</span></span><br><span class="line"><span class="string">make: *** [build_crypto] Error 1</span></span><br></pre></td></tr></table></figure><p>解决办法：<br>仔细检查提示路径下的libz.so文件是否正确。</p><h2 id="遇到的报错-3："><a href="#遇到的报错-3：" class="headerlink" title="遇到的报错-3："></a>遇到的报错-3：</h2><p>现象：<br>用Python写的脚本调用到paramiko模块，模块ssh连接加固后的机器失败，报无法连接，但secureCRT可以连接。<br>运行paromiko连接远程服务器失败：FAIL : SSHException: Incompatible ssh peer (no acceptable kex algorithm)<br>原因：<br>因为ssh6.7以上屏蔽不安全算法导致。<br>解决：<br>在/etc/ssh/sshd_config最后加上：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1</span><br></pre></td></tr></table></figure></p><p>重启sshd服务，问题解决。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;由于公司安全需要，OpenSSH要加固，需升级至当前最新版本OpenSSH_7.6p1&lt;br&gt;环境：CentOS6.8 x64&lt;br&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://www.iuwai.com/categories/Linux/"/>
    
    
      <category term="安全加固" scheme="http://www.iuwai.com/tags/%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
    
      <category term="OpenSSH" scheme="http://www.iuwai.com/tags/OpenSSH/"/>
    
  </entry>
  
</feed>
